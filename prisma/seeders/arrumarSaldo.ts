import Prisma from "../../src/infra/db/prisma";
import { decBalance } from "../../src/services/balance/decBalance";
import { addBalance } from "../../src/services/balance/addBalance";

async function arrumar() {
    const saldos = [
        {
            "id": 1974,
            "amount": -110.500000000
        },
        {
            "id": 1976,
            "amount": -21.500000000
        },
        {
            "id": 1980,
            "amount": 43.000000000
        },
        {
            "id": 1998,
            "amount": 45.500000000
        },
        {
            "id": 2020,
            "amount": -96.000000000
        },
        {
            "id": 2000,
            "amount": -23.000000000
        },
        {
            "id": 1983,
            "amount": 75.000000000
        },
        {
            "id": 2086,
            "amount": 3.000000000
        },
        {
            "id": 2042,
            "amount": 49.500000000
        },
        {
            "id": 2213,
            "amount": -72.000000000
        },
        {
            "id": 2268,
            "amount": -20.000000000
        },
        {
            "id": 2839,
            "amount": 23.000000000
        },
        {
            "id": 3653,
            "amount": 4.500000000
        },
        {
            "id": 3652,
            "amount": 1.500000000
        },
        {
            "id": 3015,
            "amount": 3.000000000
        },
        {
            "id": 2837,
            "amount": 11.500000000
        },
        {
            "id": 4333,
            "amount": 18.500000000
        },
        {
            "id": 4336,
            "amount": 67.500000000
        },
        {
            "id": 4426,
            "amount": 1.500000000
        },
        {
            "id": 4536,
            "amount": 23.000000000
        },
        {
            "id": 4793,
            "amount": -18.500000000
        },
        {
            "id": 4565,
            "amount": 6.000000000
        },
        {
            "id": 2369,
            "amount": 8.500000000
        },
        {
            "id": 2376,
            "amount": -1.500000000
        },
        {
            "id": 2372,
            "amount": 1.500000000
        },
        {
            "id": 4176,
            "amount": 23.000000000
        },
        {
            "id": 2627,
            "amount": 3.000000000
        },
        {
            "id": 6355,
            "amount": -20.000000000
        },
        {
            "id": 6405,
            "amount": -10.000000000
        },
        {
            "id": 6519,
            "amount": -1.500000000
        },
        {
            "id": 8007,
            "amount": -3.000000000
        },
        {
            "id": 2491,
            "amount": 53.000000000
        },
        {
            "id": 8066,
            "amount": 40.000000000
        },
        {
            "id": 2365,
            "amount": -4.500000000
        },
        {
            "id": 2481,
            "amount": -1.500000000
        },
        {
            "id": 2427,
            "amount": 77.000000000
        },
        {
            "id": 2230,
            "amount": 10.000000000
        },
        {
            "id": 5192,
            "amount": 32.000000000
        },
        {
            "id": 5204,
            "amount": 28.500000000
        },
        {
            "id": 5218,
            "amount": -1.500000000
        },
        {
            "id": 5215,
            "amount": -12.000000000
        },
        {
            "id": 5312,
            "amount": 14.500000000
        },
        {
            "id": 5337,
            "amount": -3.000000000
        },
        {
            "id": 6398,
            "amount": -3.000000000
        },
        {
            "id": 7135,
            "amount": 1.500000000
        },
        {
            "id": 5281,
            "amount": 1.500000000
        },
        {
            "id": 5703,
            "amount": 1.500000000
        },
        {
            "id": 5780,
            "amount": 1.500000000
        },
        {
            "id": 5760,
            "amount": 4.500000000
        },
        {
            "id": 5355,
            "amount": -8.500000000
        },
        {
            "id": 6796,
            "amount": -2.500000000
        },
        {
            "id": 6807,
            "amount": -4.500000000
        },
        {
            "id": 7384,
            "amount": -4.500000000
        },
        {
            "id": 5234,
            "amount": 7.500000000
        },
        {
            "id": 5294,
            "amount": 17.000000000
        },
        {
            "id": 5401,
            "amount": 1.500000000
        },
        {
            "id": 5779,
            "amount": 3.000000000
        },
        {
            "id": 5594,
            "amount": 1.500000000
        },
        {
            "id": 5305,
            "amount": 10.500000000
        },
        {
            "id": 5972,
            "amount": 6.000000000
        },
        {
            "id": 5930,
            "amount": 6.000000000
        },
        {
            "id": 5987,
            "amount": 10.000000000
        },
        {
            "id": 6181,
            "amount": -1.500000000
        },
        {
            "id": 6339,
            "amount": -1.500000000
        },
        {
            "id": 6389,
            "amount": 1.500000000
        },
        {
            "id": 5684,
            "amount": 1.500000000
        },
        {
            "id": 7086,
            "amount": 4.500000000
        },
        {
            "id": 4920,
            "amount": 3.500000000
        },
        {
            "id": 5626,
            "amount": 1.500000000
        },
        {
            "id": 2110,
            "amount": -23.000000000
        },
        {
            "id": 2262,
            "amount": 3.000000000
        },
        {
            "id": 2263,
            "amount": -172.500000000
        },
        {
            "id": 3194,
            "amount": 9.000000000
        },
        {
            "id": 2324,
            "amount": 3.000000000
        },
        {
            "id": 2254,
            "amount": 3.000000000
        },
        {
            "id": 2519,
            "amount": 0.500000000
        },
        {
            "id": 2242,
            "amount": 3.000000000
        },
        {
            "id": 2546,
            "amount": 3.000000000
        },
        {
            "id": 2671,
            "amount": 3.000000000
        },
        {
            "id": 2676,
            "amount": 3.000000000
        },
        {
            "id": 2695,
            "amount": 3.000000000
        },
        {
            "id": 2284,
            "amount": 3.000000000
        },
        {
            "id": 3334,
            "amount": 6.000000000
        },
        {
            "id": 2403,
            "amount": 1.500000000
        },
        {
            "id": 4058,
            "amount": 39.000000000
        },
        {
            "id": 4149,
            "amount": 39.500000000
        },
        {
            "id": 4181,
            "amount": 6.500000000
        },
        {
            "id": 5174,
            "amount": 10.000000000
        },
        {
            "id": 7280,
            "amount": 1.500000000
        },
        {
            "id": 4191,
            "amount": 3.000000000
        },
        {
            "id": 7130,
            "amount": -11.500000000
        },
        {
            "id": 4078,
            "amount": 1.500000000
        },
        {
            "id": 4255,
            "amount": 4.500000000
        },
        {
            "id": 4281,
            "amount": 1.500000000
        },
        {
            "id": 4364,
            "amount": 1.500000000
        },
        {
            "id": 4365,
            "amount": 21.000000000
        },
        {
            "id": 4490,
            "amount": 1.500000000
        },
        {
            "id": 4632,
            "amount": 1.500000000
        },
        {
            "id": 4553,
            "amount": -10.000000000
        },
        {
            "id": 4547,
            "amount": -287.000000000
        },
        {
            "id": 4983,
            "amount": -102.500000000
        },
        {
            "id": 5523,
            "amount": -3.000000000
        },
        {
            "id": 6169,
            "amount": -46.000000000
        },
        {
            "id": 5178,
            "amount": 0.500000000
        },
        {
            "id": 5179,
            "amount": -13.000000000
        },
        {
            "id": 5342,
            "amount": 3.000000000
        },
        {
            "id": 5744,
            "amount": -1.500000000
        },
        {
            "id": 5775,
            "amount": 1.500000000
        },
        {
            "id": 6422,
            "amount": 10.000000000
        },
        {
            "id": 5242,
            "amount": -3.000000000
        },
        {
            "id": 5397,
            "amount": 1.500000000
        },
        {
            "id": 5518,
            "amount": 1.500000000
        },
        {
            "id": 7279,
            "amount": -1.500000000
        },
        {
            "id": 7697,
            "amount": 1.500000000
        },
        {
            "id": 5253,
            "amount": 3.000000000
        },
        {
            "id": 5123,
            "amount": 7.500000000
        },
        {
            "id": 4551,
            "amount": -20.000000000
        },
        {
            "id": 1991,
            "amount": 10.000000000
        },
        {
            "id": 2016,
            "amount": -15.000000000
        },
        {
            "id": 2282,
            "amount": -3.000000000
        },
        {
            "id": 2089,
            "amount": -4.500000000
        },
        {
            "id": 3234,
            "amount": -3.500000000
        },
        {
            "id": 4507,
            "amount": 6.000000000
        },
        {
            "id": 4649,
            "amount": 1.500000000
        },
        {
            "id": 2339,
            "amount": -3.000000000
        },
        {
            "id": 2638,
            "amount": -1.500000000
        },
        {
            "id": 2830,
            "amount": 1.500000000
        },
        {
            "id": 5926,
            "amount": 3.000000000
        },
        {
            "id": 3002,
            "amount": -3.000000000
        },
        {
            "id": 5212,
            "amount": 1.500000000
        },
        {
            "id": 2215,
            "amount": 46.500000000
        },
        {
            "id": 2452,
            "amount": -1.500000000
        },
        {
            "id": 2486,
            "amount": -1.500000000
        },
        {
            "id": 2541,
            "amount": -1.500000000
        },
        {
            "id": 2543,
            "amount": -1.500000000
        },
        {
            "id": 2281,
            "amount": 10.500000000
        },
        {
            "id": 2271,
            "amount": 58.000000000
        },
        {
            "id": 3992,
            "amount": 4.500000000
        },
        {
            "id": 4731,
            "amount": 8.000000000
        },
        {
            "id": 4754,
            "amount": -1.500000000
        },
        {
            "id": 3303,
            "amount": 3.000000000
        },
        {
            "id": 2249,
            "amount": 10.000000000
        },
        {
            "id": 2273,
            "amount": 10.000000000
        },
        {
            "id": 2222,
            "amount": 13.000000000
        },
        {
            "id": 6907,
            "amount": 3.000000000
        },
        {
            "id": 2419,
            "amount": -10.000000000
        },
        {
            "id": 2477,
            "amount": 6.000000000
        },
        {
            "id": 2447,
            "amount": 3.000000000
        },
        {
            "id": 2099,
            "amount": -1.500000000
        },
        {
            "id": 4059,
            "amount": 1.500000000
        },
        {
            "id": 6058,
            "amount": 3.000000000
        },
        {
            "id": 2293,
            "amount": -4.500000000
        },
        {
            "id": 2916,
            "amount": -4.500000000
        },
        {
            "id": 1982,
            "amount": -40.000000000
        },
        {
            "id": 2406,
            "amount": -10.000000000
        },
        {
            "id": 2714,
            "amount": -1.500000000
        },
        {
            "id": 3664,
            "amount": -14.500000000
        },
        {
            "id": 3773,
            "amount": 3.000000000
        },
        {
            "id": 2628,
            "amount": 6.000000000
        },
        {
            "id": 2015,
            "amount": -111.500000000
        },
        {
            "id": 2081,
            "amount": -33.500000000
        },
        {
            "id": 2018,
            "amount": -40.000000000
        },
        {
            "id": 2058,
            "amount": -1740.000000000
        },
        {
            "id": 2444,
            "amount": -3.000000000
        },
        {
            "id": 2451,
            "amount": 8.000000000
        },
        {
            "id": 2511,
            "amount": -21.000000000
        },
        {
            "id": 2550,
            "amount": -1.500000000
        },
        {
            "id": 3116,
            "amount": -161.500000000
        },
        {
            "id": 2401,
            "amount": -38.000000000
        },
        {
            "id": 3485,
            "amount": -115.500000000
        },
        {
            "id": 3538,
            "amount": -281.500000000
        },
        {
            "id": 3554,
            "amount": -72.500000000
        },
        {
            "id": 3616,
            "amount": -10.500000000
        },
        {
            "id": 3601,
            "amount": 1.500000000
        },
        {
            "id": 3602,
            "amount": 1.500000000
        },
        {
            "id": 3666,
            "amount": -23.500000000
        },
        {
            "id": 2597,
            "amount": -6.000000000
        },
        {
            "id": 3072,
            "amount": -21.500000000
        },
        {
            "id": 3105,
            "amount": -23.500000000
        },
        {
            "id": 2416,
            "amount": -11.500000000
        },
        {
            "id": 3093,
            "amount": -99.500000000
        },
        {
            "id": 3125,
            "amount": -22.000000000
        },
        {
            "id": 3211,
            "amount": 1.500000000
        },
        {
            "id": 3660,
            "amount": 1.500000000
        },
        {
            "id": 3126,
            "amount": -18.000000000
        },
        {
            "id": 3157,
            "amount": -200.000000000
        },
        {
            "id": 3374,
            "amount": -140.000000000
        },
        {
            "id": 3161,
            "amount": -85.000000000
        },
        {
            "id": 3147,
            "amount": -500.000000000
        },
        {
            "id": 4025,
            "amount": -329.000000000
        },
        {
            "id": 3162,
            "amount": -10.000000000
        },
        {
            "id": 3163,
            "amount": -17.500000000
        },
        {
            "id": 2013,
            "amount": -148.500000000
        },
        {
            "id": 2047,
            "amount": -23.000000000
        },
        {
            "id": 2021,
            "amount": -493.500000000
        },
        {
            "id": 2291,
            "amount": -63.500000000
        },
        {
            "id": 2896,
            "amount": 13.500000000
        },
        {
            "id": 3203,
            "amount": -17.500000000
        },
        {
            "id": 2070,
            "amount": -217.000000000
        },
        {
            "id": 2391,
            "amount": -20.000000000
        },
        {
            "id": 2933,
            "amount": -13.000000000
        },
        {
            "id": 2095,
            "amount": -31.500000000
        },
        {
            "id": 3745,
            "amount": 0.500000000
        },
        {
            "id": 2122,
            "amount": -34.000000000
        },
        {
            "id": 2876,
            "amount": -9.000000000
        },
        {
            "id": 2173,
            "amount": -66.000000000
        },
        {
            "id": 2861,
            "amount": -348.500000000
        },
        {
            "id": 2926,
            "amount": -20.500000000
        },
        {
            "id": 3035,
            "amount": -24.500000000
        },
        {
            "id": 3222,
            "amount": 4.500000000
        },
        {
            "id": 3296,
            "amount": -1.500000000
        },
        {
            "id": 3284,
            "amount": -152.500000000
        },
        {
            "id": 3446,
            "amount": -227.500000000
        },
        {
            "id": 3478,
            "amount": -131.500000000
        },
        {
            "id": 2505,
            "amount": -49.000000000
        },
        {
            "id": 2979,
            "amount": -1.500000000
        },
        {
            "id": 3076,
            "amount": 1.500000000
        },
        {
            "id": 3593,
            "amount": 11.500000000
        },
        {
            "id": 3790,
            "amount": 10.000000000
        },
        {
            "id": 2740,
            "amount": -46.000000000
        },
        {
            "id": 4084,
            "amount": 112.000000000
        },
        {
            "id": 4123,
            "amount": 20.000000000
        },
        {
            "id": 4272,
            "amount": 1.500000000
        },
        {
            "id": 4282,
            "amount": 1.500000000
        },
        {
            "id": 4417,
            "amount": 417.000000000
        },
        {
            "id": 4432,
            "amount": -27.000000000
        },
        {
            "id": 4777,
            "amount": -3.000000000
        },
        {
            "id": 4786,
            "amount": 5.000000000
        },
        {
            "id": 4888,
            "amount": 10.000000000
        },
        {
            "id": 4801,
            "amount": -3.000000000
        },
        {
            "id": 4945,
            "amount": -1.500000000
        },
        {
            "id": 5861,
            "amount": 1.500000000
        },
        {
            "id": 5009,
            "amount": -1.500000000
        },
        {
            "id": 5069,
            "amount": 3.000000000
        },
        {
            "id": 4967,
            "amount": 6.000000000
        },
        {
            "id": 5000,
            "amount": 1.500000000
        },
        {
            "id": 5081,
            "amount": 36.000000000
        },
        {
            "id": 4847,
            "amount": -48.000000000
        },
        {
            "id": 5196,
            "amount": -1.500000000
        },
        {
            "id": 5125,
            "amount": 36.000000000
        },
        {
            "id": 5478,
            "amount": -5.000000000
        },
        {
            "id": 5588,
            "amount": 21.000000000
        },
        {
            "id": 6968,
            "amount": 101.500000000
        },
        {
            "id": 6974,
            "amount": 6.500000000
        },
        {
            "id": 6999,
            "amount": 25.000000000
        },
        {
            "id": 7054,
            "amount": 1.500000000
        },
        {
            "id": 7083,
            "amount": 1.500000000
        },
        {
            "id": 8016,
            "amount": 34.500000000
        },
        {
            "id": 7165,
            "amount": 1.500000000
        },
        {
            "id": 7019,
            "amount": 1.500000000
        },
        {
            "id": 7005,
            "amount": 63.500000000
        },
        {
            "id": 7027,
            "amount": 1.500000000
        },
        {
            "id": 7111,
            "amount": 161.500000000
        },
        {
            "id": 7114,
            "amount": 4.500000000
        },
        {
            "id": 7207,
            "amount": 4.500000000
        },
        {
            "id": 7097,
            "amount": -1.500000000
        },
        {
            "id": 7181,
            "amount": -1.500000000
        },
        {
            "id": 4496,
            "amount": 2.500000000
        },
        {
            "id": 4601,
            "amount": -58.000000000
        },
        {
            "id": 4602,
            "amount": 81.500000000
        },
        {
            "id": 4615,
            "amount": 102.000000000
        },
        {
            "id": 4616,
            "amount": 11.500000000
        },
        {
            "id": 5593,
            "amount": -1.500000000
        },
        {
            "id": 6119,
            "amount": -7.500000000
        },
        {
            "id": 6234,
            "amount": 12.000000000
        },
        {
            "id": 7804,
            "amount": 12.000000000
        },
        {
            "id": 4617,
            "amount": 6.500000000
        },
        {
            "id": 4620,
            "amount": 4.500000000
        },
        {
            "id": 4623,
            "amount": -6.500000000
        },
        {
            "id": 4766,
            "amount": -1.500000000
        },
        {
            "id": 6499,
            "amount": -7.500000000
        },
        {
            "id": 6623,
            "amount": 10.000000000
        },
        {
            "id": 7124,
            "amount": -7.500000000
        },
        {
            "id": 7802,
            "amount": -1.500000000
        },
        {
            "id": 8187,
            "amount": 30.000000000
        },
        {
            "id": 4648,
            "amount": 70.000000000
        },
        {
            "id": 7513,
            "amount": 10.000000000
        },
        {
            "id": 4725,
            "amount": 6.000000000
        },
        {
            "id": 4627,
            "amount": 53.500000000
        },
        {
            "id": 4828,
            "amount": 10.000000000
        },
        {
            "id": 4758,
            "amount": -208.500000000
        },
        {
            "id": 4760,
            "amount": -46.000000000
        },
        {
            "id": 4780,
            "amount": 43.500000000
        },
        {
            "id": 5017,
            "amount": 88.500000000
        },
        {
            "id": 5040,
            "amount": -41.500000000
        },
        {
            "id": 5094,
            "amount": 1.500000000
        },
        {
            "id": 5348,
            "amount": 30.000000000
        },
        {
            "id": 7422,
            "amount": 1.500000000
        },
        {
            "id": 5339,
            "amount": -5.000000000
        },
        {
            "id": 5396,
            "amount": 40.000000000
        },
        {
            "id": 5846,
            "amount": -19.000000000
        },
        {
            "id": 5042,
            "amount": 47.500000000
        },
        {
            "id": 5119,
            "amount": 35.000000000
        },
        {
            "id": 5165,
            "amount": 3.000000000
        },
        {
            "id": 5043,
            "amount": 9.500000000
        },
        {
            "id": 5046,
            "amount": 1.500000000
        },
        {
            "id": 5176,
            "amount": 3.000000000
        },
        {
            "id": 5210,
            "amount": 3.000000000
        },
        {
            "id": 5072,
            "amount": 4.500000000
        },
        {
            "id": 5038,
            "amount": 19.000000000
        },
        {
            "id": 5096,
            "amount": 1.500000000
        },
        {
            "id": 4977,
            "amount": 1.500000000
        },
        {
            "id": 6206,
            "amount": 9.500000000
        },
        {
            "id": 7664,
            "amount": 1.500000000
        },
        {
            "id": 4589,
            "amount": -30.500000000
        },
        {
            "id": 8227,
            "amount": -10.500000000
        },
        {
            "id": 4740,
            "amount": 4.500000000
        },
        {
            "id": 4891,
            "amount": 1.500000000
        },
        {
            "id": 8317,
            "amount": -6.000000000
        },
        {
            "id": 8283,
            "amount": -1.500000000
        },
        {
            "id": 9011,
            "amount": -3.000000000
        },
        {
            "id": 9200,
            "amount": 14.000000000
        },
        {
            "id": 2429,
            "amount": -1.500000000
        }
    ]


    for (const saldo of saldos) {

        await Prisma.$transaction(async (Prisma) => {
            console.log("--> ", saldo.id)
            if (saldo.amount > 0) {
                await addBalance({
                    name: "Conceito corrección de binario"
                    , wallet: "MAIN"
                    , user_id: saldo.id
                    , amount: saldo.amount * -1
                    , ref_type: 'correcion'
                    , ref_id: 0
                    , extra_info: {
                        ...saldo
                    }
                }, Prisma)
            } else {
                await decBalance({
                    name: "Conceito corrección de binario"
                    , wallet: "MAIN"
                    , user_id: saldo.id
                    , amount: saldo.amount * -1
                    , ref_type: 'correcion'
                    , ref_id: 0
                    , extra_info: {
                        ...saldo
                    }
                }, Prisma, true)
            }
        })


    }

}


arrumar()